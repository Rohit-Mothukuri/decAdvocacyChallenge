---
title: "Patrick’s Auto Shop Analysis"
subtitle: "Maximizing Productivity Across Your Auto Shop Network"
format:
  html: default
execute:
  echo: false
  eval: true
---

## Solution to the Business Problem

 **Where should you spend your time to maximize productivity and revenue?**

After analyzing 250 days of data, your presence makes a huge difference at Shop 4, Shop 2, and Shop 5, but not much at Shop 1 and Shop 3.


```{python}
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats

carsDF = pd.read_csv("carsFixed.csv")
carsDF["boss_label"] = carsDF["boss"].map({0: "Boss away", 1: "Boss present"})

rows = []
for shop in sorted(carsDF["shopID"].unique()):
    g0 = carsDF[(carsDF.shopID == shop) & (carsDF.boss == 0)]["carsFixed"]
    g1 = carsDF[(carsDF.shopID == shop) & (carsDF.boss == 1)]["carsFixed"]
    m0, m1 = g0.mean(), g1.mean()
    n0, n1 = len(g0), len(g1)
    s0, s1 = g0.std(ddof=1), g1.std(ddof=1)
    diff = m1 - m0
    se = np.sqrt(s0**2/n0 + s1**2/n1)
    dfree = max(n0+n1-2, 1)
    tval = stats.t.ppf(0.975, dfree)
    ci_low = diff - tval * se
    ci_high = diff + tval * se
    rows.append([shop, diff, ci_low, ci_high])

effects = pd.DataFrame(rows, columns=["shop","diff","ci_low","ci_high"])

diff_map = dict(zip(effects["shop"], effects["diff"]))

def weekly(schedule):
    return sum(diff_map[s] * d for s,d in schedule.items())

scenarioA = weekly({1:1,2:1,3:1,4:1,5:1})
scenarioB = weekly({1:0,2:1,3:0,4:3,5:1})
scenarioC = weekly({1:0,2:1,3:2,4:2,5:0})
```

## What the Data Shows

```{python}
fig, ax = plt.subplots(figsize=(6, 4))

# Create jittered positions for better visibility of all 250 points
np.random.seed(42)
for shop in range(1, 6):
    shop_data = carsDF[carsDF['shopID'] == shop]
    
    # Boss absent
    absent_data = shop_data[shop_data['boss'] == 0]
    x_absent = [shop - 0.2] * len(absent_data) + np.random.normal(0, 0.04, len(absent_data))
    ax.scatter(x_absent, absent_data['carsFixed'], 
               alpha=0.5, s=40, color='#2E86AB', edgecolors='white', linewidths=0.5,
               label='Boss Absent' if shop == 1 else '')
    
    # Boss present
    present_data = shop_data[shop_data['boss'] == 1]
    x_present = [shop + 0.2] * len(present_data) + np.random.normal(0, 0.04, len(present_data))
    ax.scatter(x_present, present_data['carsFixed'], 
               alpha=0.6, s=50, color='#F24236', edgecolors='white', linewidths=0.5,
               label='Boss Present' if shop == 1 else '')
    
    # Add mean lines for clarity
    if len(absent_data) > 0:
        ax.axvline(shop - 0.2, ymin=0, ymax=(absent_data['carsFixed'].mean() - 0) / 70, 
                   color='#2E86AB', linestyle='--', alpha=0.5, linewidth=2)
    if len(present_data) > 0:
        ax.axvline(shop + 0.2, ymin=0, ymax=(present_data['carsFixed'].mean() - 0) / 70, 
                   color='#F24236', linestyle='--', alpha=0.5, linewidth=2)

ax.set_xlabel('Shop Number', fontsize=12, fontweight='bold')
ax.set_ylabel('Cars Fixed Per Day', fontsize=12, fontweight='bold')
ax.set_title('250 Days of Data: Your Presence Boosts Productivity at Shop 4, Shop 2, and Shop 5', 
             fontsize=12, fontweight='bold', pad=20)
ax.set_xticks(range(1, 6))
ax.set_xticklabels([f'Shop {i}' for i in range(1, 6)])
ax.legend(loc='upper left', fontsize=11, framealpha=0.9)
ax.grid(True, alpha=0.3, axis='y')
ax.set_ylim(0, 70)

plt.tight_layout()
plt.show()
```

You can see it right away: Shop 4, Shop 2, and Shop 5's orange dots (when you're there) are clearly higher than the blue ones. The **dotted lines show the average**. notice how the orange dotted line is much higher than the blue one at these shops. At Shop 1 and Shop 3, the dots are more mixed together and the dotted lines are closer together—your presence doesn't seem to matter as much.

Here are the exact numbers:

### Average Improvement When Patrick Is Present

```{python}
#| echo: false
effects_rounded = effects.copy()
effects_rounded[['diff', 'ci_low', 'ci_high']] = effects_rounded[['diff', 'ci_low', 'ci_high']].round(2)
print(effects_rounded.to_string(index=False))
```

## Your Impact at Each Shop

**Shop 4:** **+12.8 extra cars per day** on average. Expect 7-18 extra cars per day—that's the range.

**Shop 2:** **+10.1 extra cars per day** on average. Expect 6-14 extra cars per day.

**Shop 5:** **+8.2 extra cars per day** on average. Expect 4-12 extra cars per day.

**Shop 1:** **+6.9 extra cars per day** on average. Expect 5-9 extra cars per day.

**Shop 3:** Only **+2.9 cars per day**, and this could be random chance. You might not be helping at all.


### Impact Visualization

```{python}
plt.figure(figsize=(8,6))
sns.pointplot(data=effects, x="shop", y="diff", linestyle='none')
for i,row in effects.iterrows():
    plt.plot([i,i],[row.ci_low, row.ci_high], marker="_")
plt.title("Impact of Patrick's Presence: Extra Cars per Day")
plt.xlabel("Shop")
plt.ylabel("Extra Cars per Day")
plt.tight_layout()
plt.show()
```

## Confidence and Uncertainty

We only have **250 days of data**, and some shops have fewer days recorded with you present.  
This means:

- The exact numbers are **estimates**, not guarantees  
- Confidence intervals show **reasonable ranges** for your impact  

The strongest and most reliable impact appears in **Shops 4, 2, and 5**.  
Shop 3 shows a small and uncertain improvement.

## Scheduling Scenarios

### Weekly Extra Cars Under Different Plans

```{python}
import pandas as pd
scenarioDF = pd.DataFrame({
    "Scenario":["Even Rotation","High Impact (Shop4 Focus)","Brother-Friendly"],
    "ExtraCars":[scenarioA, scenarioB, scenarioC]
})
scenarioDF
```

### Scenario Visualization

```{python}
plt.figure(figsize=(8,6))
sns.barplot(data=scenarioDF, x="Scenario", y="ExtraCars",width=0.3)
plt.title("Projected Extra Cars per Week by Strategy")
plt.ylabel("Extra Cars per Week")
plt.xticks(rotation=20, ha="right")
plt.tight_layout()
plt.show()
```

## Recommendations

- Spend most of your time in **Shop 4**, where your presence produces the largest productivity gain.  
- Prioritize **Shop 2** and **Shop 5** next—they show strong, consistent improvement when you are present.  
- **Shop 3** offers the least productivity benefit; visit mainly for personal reasons.  
- To maximize weekly output, a strong schedule is:
  - **3 days in Shop 4**
  - **1 day in Shop 2**
  - **1 day in Shop 5**

## Final Takeaway

Your presence meaningfully increases productivity, especially in Shops **4, 2, and 5**.  
By focusing your time strategically, you can maximize total cars fixed and total revenue each week.
